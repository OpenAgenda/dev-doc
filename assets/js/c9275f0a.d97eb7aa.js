"use strict";(self.webpackChunkdev_doc=self.webpackChunkdev_doc||[]).push([[554],{5925:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>u,frontMatter:()=>r,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"evenements/creation","title":"Cr\xe9ation d\'un \xe9v\xe9nement","description":"Cr\xe9er un nouvel \xe9v\xe9nement sur un agenda en suivant la m\xe9thode usuelle ou avec un identifiant externe \xe0 OpenAgenda","source":"@site/docs/evenements/creation.md","sourceDirName":"evenements","slug":"/evenements/creation","permalink":"/evenements/creation","draft":false,"unlisted":false,"editUrl":"https://github.com/OpenAgenda/dev-doc/docs/evenements/creation.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Cr\xe9ation d\'un \xe9v\xe9nement","description":"Cr\xe9er un nouvel \xe9v\xe9nement sur un agenda en suivant la m\xe9thode usuelle ou avec un identifiant externe \xe0 OpenAgenda","sidebar_position":3},"sidebar":"apiSidebar","previous":{"title":"Lecture","permalink":"/evenements/lecture"},"next":{"title":"\xc9dition","permalink":"/evenements/edition"}}');var a=i(1903),s=i(6338);const r={title:"Cr\xe9ation d'un \xe9v\xe9nement",description:"Cr\xe9er un nouvel \xe9v\xe9nement sur un agenda en suivant la m\xe9thode usuelle ou avec un identifiant externe \xe0 OpenAgenda",sidebar_position:3},d="Cr\xe9ation d'un \xe9v\xe9nement",o={},l=[{value:"M\xe9thode usuelle",id:"m\xe9thode-usuelle",level:2},{value:"En bref",id:"en-bref",level:3},{value:"Exemples",id:"exemples",level:3},{value:"Cas le plus basique",id:"cas-le-plus-basique",level:4},{value:"node.js",id:"nodejs",level:5},{value:"Un \xe9v\xe9nement multilingue",id:"un-\xe9v\xe9nement-multilingue",level:4},{value:"node.js",id:"nodejs-1",level:5},{value:"Un \xe9v\xe9nement avec champs additionnels",id:"un-\xe9v\xe9nement-avec-champs-additionnels",level:4},{value:"\xc9v\xe9nement avec image fournie par fichier",id:"\xe9v\xe9nement-avec-image-fournie-par-fichier",level:4},{value:"node.js &amp; axios",id:"nodejs--axios",level:5},{value:"Cr\xe9ation par identifiant externe",id:"cr\xe9ation-par-identifiant-externe",level:2},{value:"En bref",id:"en-bref-1",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"cr\xe9ation-dun-\xe9v\xe9nement",children:"Cr\xe9ation d'un \xe9v\xe9nement"})}),"\n",(0,a.jsx)(n.h2,{id:"m\xe9thode-usuelle",children:"M\xe9thode usuelle"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"POST /v2/agendas/{agendaUID}/events\n"})}),"\n",(0,a.jsx)(n.h3,{id:"en-bref",children:"En bref"}),"\n",(0,a.jsxs)(n.p,{children:["Cette route permet la cr\xe9ation d'un \xe9v\xe9nement ",(0,a.jsx)(n.strong,{children:"dans le contexte d'un agenda"}),". Ceci signifie qu'au del\xe0 des valeurs des ",(0,a.jsx)(n.a,{href:"/evenements/structure#champs-standards",children:"champs standard"})," de l'\xe9v\xe9nement, les valeurs associ\xe9es aux champs additionnels de l'agenda peuvent \xeatre d\xe9finis."]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"agendaUID"})," est l'identifiant unique de l'agenda o\xf9 les \xe9v\xe9nements sont r\xe9f\xe9renc\xe9s"]}),"\n",(0,a.jsxs)(n.li,{children:["Une ",(0,a.jsx)(n.a,{href:"/authentification",children:"authentification"})," en \xe9criture par jeton d'acc\xe8s est requise"]}),"\n",(0,a.jsxs)(n.li,{children:["Un param\xe8tre ",(0,a.jsx)(n.code,{children:"lang"})," peut \xeatre pr\xe9cis\xe9 en ent\xeate (",(0,a.jsx)(n.code,{children:"lang:fr"}),") pour simplifier le formatage d'\xe9v\xe9nements monolingues"]}),"\n",(0,a.jsxs)(n.li,{children:["Pour les \xe9v\xe9nements ",(0,a.jsx)(n.a,{href:"/evenements/structure#mode-de-participation",children:"physiques/in situ"}),", il est n\xe9cessaire de les lier \xe0 un lieu par son identifiant. Ce dernier doit \xeatre connu au moment de la cr\xe9ation de l'\xe9v\xe9nement."]}),"\n",(0,a.jsxs)(n.li,{children:["Les donn\xe9es d\xe9finissant l'\xe9v\xe9nement doivent \xeatre plac\xe9es sous une cl\xe9 ",(0,a.jsx)(n.code,{children:"data"})," en corps de requ\xeate."]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"exemples",children:"Exemples"}),"\n",(0,a.jsx)(n.h4,{id:"cas-le-plus-basique",children:"Cas le plus basique"}),"\n",(0,a.jsx)(n.p,{children:"\xc0 minima, un \xe9v\xe9nement doit avoir les informations suivantes de d\xe9finies: un titre, une description courte, une plage horaire, un lieu."}),"\n",(0,a.jsx)(n.h5,{id:"nodejs",children:"node.js"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"import axios from 'axios';\nimport getImageURL from './getImageURL.js';\nimport getAccessToken from './getAccessToken.js';\nimport getAgendaUID from './getAgendaUID.js';\nimport getLocationUID from './getLocationUID.js';\n\nconst {\n  data: {\n    event: createdEvent,\n  },\n} = await axios({\n  method: 'post',\n  url: `https://api.openagenda.com/v2/agendas/${getAgendaUID()}/events`,\n  headers: {\n    'access-token': getAccessToken(),\n    'content-type': 'application/json',\n    'lang': 'fr',\n  },\n  data: {\n    title: 'Un \xe9t\xe9 au cin\xe9, cin\xe9ma en plein air - Donne moi des ailes',\n    description: 'De Nicolas Vanier - 2019 / 1h53 - Avec Louis Vazquez, Jean-Paul Rouve, M\xe9lanie Doutey',\n    locationUid: getLocationUID(),\n    timings: [{\n      begin: '2025-08-06T21:30:00.000+0200',\n      end: '2025-08-06T23:30:00.000+0200'\n    }],\n  }\n});\n"})}),"\n",(0,a.jsx)(n.h4,{id:"un-\xe9v\xe9nement-multilingue",children:"Un \xe9v\xe9nement multilingue"}),"\n",(0,a.jsxs)(n.p,{children:["Les champs ",(0,a.jsx)(n.code,{children:"title"}),", ",(0,a.jsx)(n.code,{children:"description"}),", ",(0,a.jsx)(n.code,{children:"longDescription"}),", ",(0,a.jsx)(n.code,{children:"keywords"})," et ",(0,a.jsx)(n.code,{children:"conditions"})," sont multilingues. Les variantes de chaque langue sont \xe0 placer derri\xe8re des cl\xe9s correspondant au code langue."]}),"\n",(0,a.jsx)(n.h5,{id:"nodejs-1",children:"node.js"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"...\n\nconst {\n  data: {\n    event: createdEvent,\n  },\n} = await axios({\n  method: 'post',\n  url: `https://api.openagenda.com/v2/agendas/${getAgendaUID()}/events`,\n  headers: {\n    'access-token': getAccessToken(),\n    'content-type': 'application/json',\n  },\n  data: {\n    title: {\n      fr: 'Un \xe9t\xe9 au cin\xe9, cin\xe9ma en plein air - Donne moi des ailes',\n      en: 'A summer at the movies, open-air cinema - Give me wings',\n    },\n    description: {\n      fr: 'De Nicolas Vanier - 2019 / 1h53 - Avec Louis Vazquez, Jean-Paul Rouve, M\xe9lanie Doutey',\n      en: 'From Nicola Vanier - 2019 / 1h53 - With Louis Vazquez, Jean-Paul Rouve, M\xe9lanie Doutey',\n    },\n    keywords: {\n      fr: ['cin\xe9', 'projection'],\n      en: ['movies', 'projection'],\n    },\n    ...\n  },\n});\n"})}),"\n",(0,a.jsx)(n.h4,{id:"un-\xe9v\xe9nement-avec-champs-additionnels",children:"Un \xe9v\xe9nement avec champs additionnels"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"/agendas/schemas",children:"Voir ici"})," pour des d\xe9tails sur le fonctionnement des champs additionnels."]}),"\n",(0,a.jsx)(n.p,{children:"Pour cet exemple, l'agenda \xe0 le champ additionnel suivant de d\xe9fini:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "field": "thematique",\n  "label": "Th\xe9matique",\n  "optional": false,\n  "options": [\n      {\n          "id": 15,\n          "value": "vie-associative",\n          "label": "Vie associative"\n      },\n      {\n          "id": 8,\n          "value": "numerique",\n          "label": "Num\xe9rique"\n      },\n      {\n          "id": 61,\n          "value": "culture",\n          "label": "Culture"\n      },\n      ...\n  ],\n  "fieldType": "checkbox",\n  "schemaType": "network"\n},\n'})}),"\n",(0,a.jsxs)(n.p,{children:["L'\xe9v\xe9nement cr\xe9\xe9 doit \xeatre associ\xe9 \xe0 la th\xe9matique ",(0,a.jsx)(n.code,{children:"Culture"}),":"]}),"\n",(0,a.jsx)(n.h5,{id:""}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"...\n\nconst {\n  data: {\n    event: createdEvent,\n  },\n} = await axios({\n  method: 'post',\n  url: `https://api.openagenda.com/v2/agendas/${getAgendaUID()}/events`,\n  headers: {\n    'access-token': getAccessToken(),\n    'content-type': 'application/json',\n  },\n  data: {\n    title: {\n      fr: 'Un \xe9t\xe9 au cin\xe9, cin\xe9ma en plein air - Donne moi des ailes',\n    },\n    ...,\n    thematique: [61],\n  },\n});\n"})}),"\n",(0,a.jsx)(n.h4,{id:"\xe9v\xe9nement-avec-image-fournie-par-fichier",children:"\xc9v\xe9nement avec image fournie par fichier"}),"\n",(0,a.jsx)(n.h5,{id:"nodejs--axios",children:"node.js & axios"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"import FormData from 'form-data';\nimport fs from 'fs';\nimport path from 'path';\nimport axios from 'axios';\nimport getAccessToken from './getAccessToken.js';\nimport getAgendaUID from './getAgendaUID.js';\n\nconst imageStream = fs.createReadStream(path.resolve('./image.png'));\n\nconst form = new FormData();\n\nform.append('data', JSON.stringify({\n  title: `Titre de l'\xe9v\xe9nement`,\n  description: `Description courte de l'\xe9v\xe9nement`,\n  attendanceMode: 2,\n  onlineAccessLink: 'https://openagenda.com',\n  timings: [{\n    begin: '2025-08-30T10:00:00+0200',\n    end: '2025-08-30T11:00:00+0200',\n  }]\n));\nform.append('image', imageStream);\n\nawait axios({\n  method: 'POST',\n  url: `https://api.openagenda.com/v2/agendas/${getAgendaUID()}/events`,\n  headers: {\n    ...form.getHeaders(),\n    'access-token': await getAccessToken(),\n  },\n  data: form,\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"cr\xe9ation-par-identifiant-externe",children:"Cr\xe9ation par identifiant externe"}),"\n",(0,a.jsxs)(n.p,{children:["Un \xe9v\xe9nement peut \xeatre cr\xe9\xe9 via un ",(0,a.jsx)(n.a,{href:"/evenements/structure#identifiants-externes",children:"identifiant externe"})," \xe0 OpenAgenda. La m\xeame route sert \xe9galement pour les mise \xe0 jour, lorsqu'un \xe9v\xe9nement existe d\xe9j\xe0 pour l'identifiant donn\xe9:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"PUT /v2/agendas/{agendaUID}/events/ext/{key}/{value}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"en-bref-1",children:"En bref"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"key"})," est le nom de l'identifiant, ",(0,a.jsx)(n.code,{children:"value"})," sa valeur"]}),"\n",(0,a.jsx)(n.li,{children:"Si l'\xe9v\xe9nement existe d\xe9j\xe0, il sera mis \xe0 jour"}),"\n",(0,a.jsx)(n.li,{children:"Un \xe9v\xe9nement peut \xeatre associ\xe9 \xe0 plusieurs identifiants externes"}),"\n",(0,a.jsxs)(n.li,{children:["Un \xe9v\xe9nement associ\xe9 \xe0 un ou plusieurs identifiants externes garde un identifiant OpenAgenda unique ",(0,a.jsx)(n.code,{children:"UID"}),"."]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},6338:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>d});var t=i(7);const a={},s=t.createContext(a);function r(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);