"use strict";(self.webpackChunkdev_doc=self.webpackChunkdev_doc||[]).push([[583],{3214:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>p,frontMatter:()=>d,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"agendas/suppression","title":"Suppression d\'agendas","description":"L\'API OpenAgenda permet de supprimer des agendas existants. Attention : cette action est irr\xe9versible.","source":"@site/docs/agendas/suppression.md","sourceDirName":"agendas","slug":"/agendas/suppression","permalink":"/agendas/suppression","draft":false,"unlisted":false,"editUrl":"https://github.com/OpenAgenda/dev-doc/docs/agendas/suppression.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5}}');var i=s(4373),a=s(7672);const d={sidebar_position:5},t="Suppression d'agendas",o={},l=[{value:"Supprimer un agenda",id:"supprimer-un-agenda",level:2},{value:"Requ\xeate",id:"requ\xeate",level:3},{value:"Param\xe8tres d&#39;URL",id:"param\xe8tres-durl",level:3},{value:"Exemple de requ\xeate",id:"exemple-de-requ\xeate",level:3},{value:"R\xe9ponse de suppression",id:"r\xe9ponse-de-suppression",level:3},{value:"Cons\xe9quences de la suppression",id:"cons\xe9quences-de-la-suppression",level:2},{value:"Donn\xe9es supprim\xe9es",id:"donn\xe9es-supprim\xe9es",level:3},{value:"Donn\xe9es conserv\xe9es",id:"donn\xe9es-conserv\xe9es",level:3},{value:"Restrictions de suppression",id:"restrictions-de-suppression",level:2},{value:"Agendas non supprimables",id:"agendas-non-supprimables",level:3},{value:"Erreur de suppression interdite",id:"erreur-de-suppression-interdite",level:3},{value:"Suppression s\xe9curis\xe9e",id:"suppression-s\xe9curis\xe9e",level:2},{value:"V\xe9rification pr\xe9alable",id:"v\xe9rification-pr\xe9alable",level:3},{value:"Exemple de v\xe9rification",id:"exemple-de-v\xe9rification",level:3},{value:"Gestion des erreurs",id:"gestion-des-erreurs",level:2},{value:"Agenda non trouv\xe9",id:"agenda-non-trouv\xe9",level:3},{value:"Permissions insuffisantes",id:"permissions-insuffisantes",level:3},{value:"Exemples d&#39;impl\xe9mentation",id:"exemples-dimpl\xe9mentation",level:2},{value:"JavaScript",id:"javascript",level:3},{value:"Python",id:"python",level:3},{value:"PHP",id:"php",level:3},{value:"Bonnes pratiques",id:"bonnes-pratiques",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"suppression-dagendas",children:"Suppression d'agendas"})}),"\n",(0,i.jsxs)(n.p,{children:["L'API OpenAgenda permet de supprimer des agendas existants. ",(0,i.jsx)(n.strong,{children:"Attention : cette action est irr\xe9versible."})]}),"\n",(0,i.jsx)(n.h2,{id:"supprimer-un-agenda",children:"Supprimer un agenda"}),"\n",(0,i.jsx)(n.h3,{id:"requ\xeate",children:"Requ\xeate"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"DELETE /v2/agendas/{uid}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"param\xe8tres-durl",children:"Param\xe8tres d'URL"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Param\xe8tre"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"uid"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Identifiant unique de l'agenda \xe0 supprimer"})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"exemple-de-requ\xeate",children:"Exemple de requ\xeate"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X DELETE \\\n  -H "Authorization: Bearer YOUR_API_KEY" \\\n  https://api.openagenda.com/v2/agendas/agenda-456\n'})}),"\n",(0,i.jsx)(n.h3,{id:"r\xe9ponse-de-suppression",children:"R\xe9ponse de suppression"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "message": "Agenda supprim\xe9 avec succ\xe8s",\n    "deletedAt": "2024-03-15T16:45:00Z"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"cons\xe9quences-de-la-suppression",children:"Cons\xe9quences de la suppression"}),"\n",(0,i.jsx)(n.h3,{id:"donn\xe9es-supprim\xe9es",children:"Donn\xe9es supprim\xe9es"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"L'agenda"})," et toutes ses m\xe9tadonn\xe9es"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Tous les \xe9v\xe9nements"})," associ\xe9s \xe0 cet agenda"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Les statistiques"})," de l'agenda"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Les abonnements"})," des utilisateurs"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"donn\xe9es-conserv\xe9es",children:"Donn\xe9es conserv\xe9es"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Les lieux"})," r\xe9f\xe9renc\xe9s restent disponibles"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"L'historique"})," dans les logs syst\xe8me (30 jours)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"restrictions-de-suppression",children:"Restrictions de suppression"}),"\n",(0,i.jsx)(n.h3,{id:"agendas-non-supprimables",children:"Agendas non supprimables"}),"\n",(0,i.jsx)(n.p,{children:"Certains agendas ne peuvent pas \xeatre supprim\xe9s :"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Agendas officiels"})," (",(0,i.jsx)(n.code,{children:"official: true"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Agendas avec plus de 1000 \xe9v\xe9nements"})," (contactez le support)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Agendas partag\xe9s"})," avec d'autres utilisateurs"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"erreur-de-suppression-interdite",children:"Erreur de suppression interdite"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "success": false,\n  "error": {\n    "code": "DELETION_NOT_ALLOWED",\n    "message": "Cet agenda ne peut pas \xeatre supprim\xe9",\n    "details": {\n      "reason": "official_agenda",\n      "description": "Les agendas officiels ne peuvent pas \xeatre supprim\xe9s"\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"suppression-s\xe9curis\xe9e",children:"Suppression s\xe9curis\xe9e"}),"\n",(0,i.jsx)(n.h3,{id:"v\xe9rification-pr\xe9alable",children:"V\xe9rification pr\xe9alable"}),"\n",(0,i.jsx)(n.p,{children:"Avant de supprimer un agenda, il est recommand\xe9 de :"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Sauvegarder les donn\xe9es"})," importantes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"V\xe9rifier le nombre d'\xe9v\xe9nements"})," associ\xe9s"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Informer les utilisateurs"})," concern\xe9s"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"exemple-de-v\xe9rification",children:"Exemple de v\xe9rification"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# V\xe9rifier les d\xe9tails de l\'agenda\ncurl -H "Authorization: Bearer YOUR_API_KEY" \\\n  https://api.openagenda.com/v2/agendas/agenda-456\n\n# V\xe9rifier les \xe9v\xe9nements associ\xe9s\ncurl -H "Authorization: Bearer YOUR_API_KEY" \\\n  "https://api.openagenda.com/v2/events?agenda=agenda-456&limit=1"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"gestion-des-erreurs",children:"Gestion des erreurs"}),"\n",(0,i.jsx)(n.h3,{id:"agenda-non-trouv\xe9",children:"Agenda non trouv\xe9"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "success": false,\n  "error": {\n    "code": "AGENDA_NOT_FOUND",\n    "message": "Agenda non trouv\xe9"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"permissions-insuffisantes",children:"Permissions insuffisantes"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "success": false,\n  "error": {\n    "code": "INSUFFICIENT_PERMISSIONS",\n    "message": "Vous n\'avez pas les permissions pour supprimer cet agenda"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"exemples-dimpl\xe9mentation",children:"Exemples d'impl\xe9mentation"}),"\n",(0,i.jsx)(n.h3,{id:"javascript",children:"JavaScript"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"async function deleteAgenda(uid, options = {}) {\n  // V\xe9rification optionnelle\n  if (options.confirm) {\n    const confirmed = confirm(`\xcates-vous s\xfbr de vouloir supprimer l'agenda ${uid} ?`);\n    if (!confirmed) return { cancelled: true };\n  }\n  \n  try {\n    const response = await fetch(`https://api.openagenda.com/v2/agendas/${uid}`, {\n      method: 'DELETE',\n      headers: {\n        'Authorization': 'Bearer YOUR_API_KEY'\n      }\n    });\n    \n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error.message);\n    }\n    \n    return await response.json();\n    \n  } catch (error) {\n    console.error('Erreur lors de la suppression:', error.message);\n    throw error;\n  }\n}\n\n// Utilisation avec confirmation\ndeleteAgenda('agenda-456', { confirm: true })\n  .then(result => {\n    if (result.cancelled) {\n      console.log('Suppression annul\xe9e');\n    } else {\n      console.log('Agenda supprim\xe9 avec succ\xe8s');\n    }\n  })\n  .catch(error => console.error('Erreur:', error));\n"})}),"\n",(0,i.jsx)(n.h3,{id:"python",children:"Python"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import requests\n\ndef delete_agenda(uid, confirm=False):\n    if confirm:\n        response = input(f\"\xcates-vous s\xfbr de vouloir supprimer l'agenda {uid} ? (oui/non): \")\n        if response.lower() != 'oui':\n            print(\"Suppression annul\xe9e\")\n            return None\n    \n    url = f\"https://api.openagenda.com/v2/agendas/{uid}\"\n    headers = {'Authorization': 'Bearer YOUR_API_KEY'}\n    \n    response = requests.delete(url, headers=headers)\n    \n    if response.status_code == 200:\n        return response.json()['data']\n    else:\n        error = response.json()\n        raise Exception(f\"Erreur: {error['error']['message']}\")\n\n# Utilisation\ntry:\n    result = delete_agenda('agenda-456', confirm=True)\n    if result:\n        print(f\"Agenda supprim\xe9 \xe0: {result['deletedAt']}\")\nexcept Exception as e:\n    print(f\"Erreur: {e}\")\n"})}),"\n",(0,i.jsx)(n.h3,{id:"php",children:"PHP"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"function deleteAgenda($uid, $confirm = false) {\n    if ($confirm) {\n        echo \"\xcates-vous s\xfbr de vouloir supprimer l'agenda {$uid} ? (oui/non): \";\n        $input = trim(fgets(STDIN));\n        if (strtolower($input) !== 'oui') {\n            echo \"Suppression annul\xe9e\\n\";\n            return null;\n        }\n    }\n    \n    $url = \"https://api.openagenda.com/v2/agendas/\" . $uid;\n    $headers = ['Authorization: Bearer YOUR_API_KEY'];\n    \n    $ch = curl_init();\n    curl_setopt($ch, CURLOPT_URL, $url);\n    curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'DELETE');\n    curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n    \n    $response = curl_exec($ch);\n    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);\n    \n    if ($httpCode === 200) {\n        return json_decode($response, true)['data'];\n    } else {\n        $error = json_decode($response, true);\n        throw new Exception(\"Erreur: \" . $error['error']['message']);\n    }\n}\n\n// Utilisation\ntry {\n    $result = deleteAgenda('agenda-456', true);\n    if ($result) {\n        echo \"Agenda supprim\xe9 avec succ\xe8s\\n\";\n    }\n} catch (Exception $e) {\n    echo \"Erreur: \" . $e->getMessage() . \"\\n\";\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"bonnes-pratiques",children:"Bonnes pratiques"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Toujours confirmer"})," avant suppression"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Sauvegarder"})," les donn\xe9es importantes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"V\xe9rifier les permissions"})," avant suppression"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"G\xe9rer les erreurs"})," appropri\xe9ment"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Informer les utilisateurs"})," concern\xe9s"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},7672:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>t});var r=s(4897);const i={},a=r.createContext(i);function d(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);