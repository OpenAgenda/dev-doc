"use strict";(self.webpackChunkdev_doc=self.webpackChunkdev_doc||[]).push([[877],{3862:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"agendas/modification","title":"Modification d\'agendas","description":"L\'API OpenAgenda permet de modifier les agendas existants via des requ\xeates PUT ou PATCH.","source":"@site/docs/agendas/modification.md","sourceDirName":"agendas","slug":"/agendas/modification","permalink":"/agendas/modification","draft":false,"unlisted":false,"editUrl":"https://github.com/OpenAgenda/dev-doc/docs/agendas/modification.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4}}');var i=s(4373),t=s(7672);const d={sidebar_position:4},a="Modification d'agendas",l={},o=[{value:"Modifier un agenda (PUT)",id:"modifier-un-agenda-put",level:2},{value:"Requ\xeate",id:"requ\xeate",level:3},{value:"Corps de la requ\xeate",id:"corps-de-la-requ\xeate",level:3},{value:"Exemple de requ\xeate",id:"exemple-de-requ\xeate",level:3},{value:"Modification partielle (PATCH)",id:"modification-partielle-patch",level:2},{value:"Requ\xeate",id:"requ\xeate-1",level:3},{value:"Corps de la requ\xeate (partiel)",id:"corps-de-la-requ\xeate-partiel",level:3},{value:"Exemple de requ\xeate PATCH",id:"exemple-de-requ\xeate-patch",level:3},{value:"R\xe9ponse de modification",id:"r\xe9ponse-de-modification",level:2},{value:"Champs modifiables",id:"champs-modifiables",level:2},{value:"Champs principaux",id:"champs-principaux",level:3},{value:"Champs de configuration",id:"champs-de-configuration",level:3},{value:"Champs en lecture seule",id:"champs-en-lecture-seule",level:3},{value:"Gestion des erreurs",id:"gestion-des-erreurs",level:2},{value:"Erreur de slug d\xe9j\xe0 utilis\xe9",id:"erreur-de-slug-d\xe9j\xe0-utilis\xe9",level:3},{value:"Erreur de validation",id:"erreur-de-validation",level:3},{value:"Exemples d&#39;impl\xe9mentation",id:"exemples-dimpl\xe9mentation",level:2},{value:"JavaScript",id:"javascript",level:3},{value:"Python",id:"python",level:3},{value:"PHP",id:"php",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"modification-dagendas",children:"Modification d'agendas"})}),"\n",(0,i.jsx)(n.p,{children:"L'API OpenAgenda permet de modifier les agendas existants via des requ\xeates PUT ou PATCH."}),"\n",(0,i.jsx)(n.h2,{id:"modifier-un-agenda-put",children:"Modifier un agenda (PUT)"}),"\n",(0,i.jsx)(n.p,{children:"La m\xe9thode PUT remplace enti\xe8rement l'agenda avec les nouvelles donn\xe9es."}),"\n",(0,i.jsx)(n.h3,{id:"requ\xeate",children:"Requ\xeate"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"PUT /v2/agendas/{uid}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"corps-de-la-requ\xeate",children:"Corps de la requ\xeate"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "title": "Nouveau titre",\n  "description": "Nouvelle description",\n  "slug": "nouveau-slug",\n  "private": true,\n  "settings": {\n    "timezone": "Europe/London",\n    "language": "en",\n    "moderation": "manual",\n    "categories": ["workshop", "conference"]\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"exemple-de-requ\xeate",children:"Exemple de requ\xeate"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X PUT \\\n  -H "Authorization: Bearer YOUR_API_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "title": "\xc9v\xe9nements Tech Paris - Mis \xe0 jour",\n    "description": "Version mise \xe0 jour des \xe9v\xe9nements tech parisiens",\n    "slug": "tech-paris-v2",\n    "private": false,\n    "settings": {\n      "timezone": "Europe/Paris",\n      "language": "fr",\n      "moderation": "auto",\n      "categories": ["conference", "workshop", "meetup", "hackathon"]\n    }\n  }\' \\\n  https://api.openagenda.com/v2/agendas/agenda-456\n'})}),"\n",(0,i.jsx)(n.h2,{id:"modification-partielle-patch",children:"Modification partielle (PATCH)"}),"\n",(0,i.jsx)(n.p,{children:"La m\xe9thode PATCH permet de modifier seulement certains champs."}),"\n",(0,i.jsx)(n.h3,{id:"requ\xeate-1",children:"Requ\xeate"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"PATCH /v2/agendas/{uid}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"corps-de-la-requ\xeate-partiel",children:"Corps de la requ\xeate (partiel)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "title": "Nouveau titre seulement",\n  "settings": {\n    "moderation": "manual"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"exemple-de-requ\xeate-patch",children:"Exemple de requ\xeate PATCH"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH \\\n  -H "Authorization: Bearer YOUR_API_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "description": "Description mise \xe0 jour",\n    "settings": {\n      "categories": ["conference", "workshop", "meetup"]\n    }\n  }\' \\\n  https://api.openagenda.com/v2/agendas/agenda-456\n'})}),"\n",(0,i.jsx)(n.h2,{id:"r\xe9ponse-de-modification",children:"R\xe9ponse de modification"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "uid": "agenda-456",\n    "title": "\xc9v\xe9nements Tech Paris - Mis \xe0 jour",\n    "description": "Version mise \xe0 jour des \xe9v\xe9nements tech parisiens",\n    "slug": "tech-paris-v2",\n    "official": false,\n    "featured": false,\n    "private": false,\n    "createdAt": "2024-03-15T10:00:00Z",\n    "updatedAt": "2024-03-15T15:30:00Z",\n    "settings": {\n      "timezone": "Europe/Paris",\n      "language": "fr",\n      "moderation": "auto",\n      "categories": ["conference", "workshop", "meetup", "hackathon"]\n    },\n    "stats": {\n      "eventsCount": 12,\n      "viewsCount": 156,\n      "subscribersCount": 8\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"champs-modifiables",children:"Champs modifiables"}),"\n",(0,i.jsx)(n.h3,{id:"champs-principaux",children:"Champs principaux"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Champ"}),(0,i.jsx)(n.th,{children:"Modifiable"}),(0,i.jsx)(n.th,{children:"Contraintes"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"title"})}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"5-100 caract\xe8res"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"description"})}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"10-500 caract\xe8res"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"slug"})}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"Unique, format valide"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"private"})}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"boolean"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"champs-de-configuration",children:"Champs de configuration"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Champ"}),(0,i.jsx)(n.th,{children:"Modifiable"}),(0,i.jsx)(n.th,{children:"Contraintes"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"settings.timezone"})}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"Timezone valide"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"settings.language"})}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"Code ISO 639-1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"settings.moderation"})}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"auto, manual, none"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"settings.categories"})}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"Maximum 10 cat\xe9gories"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"champs-en-lecture-seule",children:"Champs en lecture seule"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Champ"}),(0,i.jsx)(n.th,{children:"Modifiable"}),(0,i.jsx)(n.th,{children:"Raison"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"uid"})}),(0,i.jsx)(n.td,{children:"\u274c"}),(0,i.jsx)(n.td,{children:"Identifiant unique"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"createdAt"})}),(0,i.jsx)(n.td,{children:"\u274c"}),(0,i.jsx)(n.td,{children:"Date de cr\xe9ation"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"official"})}),(0,i.jsx)(n.td,{children:"\u274c"}),(0,i.jsx)(n.td,{children:"Statut g\xe9r\xe9 par OpenAgenda"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"featured"})}),(0,i.jsx)(n.td,{children:"\u274c"}),(0,i.jsx)(n.td,{children:"Statut g\xe9r\xe9 par OpenAgenda"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"stats"})}),(0,i.jsx)(n.td,{children:"\u274c"}),(0,i.jsx)(n.td,{children:"Calcul\xe9 automatiquement"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"gestion-des-erreurs",children:"Gestion des erreurs"}),"\n",(0,i.jsx)(n.h3,{id:"erreur-de-slug-d\xe9j\xe0-utilis\xe9",children:"Erreur de slug d\xe9j\xe0 utilis\xe9"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "success": false,\n  "error": {\n    "code": "SLUG_ALREADY_EXISTS",\n    "message": "Ce slug est d\xe9j\xe0 utilis\xe9 par un autre agenda"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"erreur-de-validation",children:"Erreur de validation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "success": false,\n  "error": {\n    "code": "VALIDATION_ERROR",\n    "message": "Donn\xe9es invalides",\n    "details": {\n      "fields": [\n        {\n          "field": "settings.categories",\n          "message": "Maximum 10 cat\xe9gories autoris\xe9es"\n        }\n      ]\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"exemples-dimpl\xe9mentation",children:"Exemples d'impl\xe9mentation"}),"\n",(0,i.jsx)(n.h3,{id:"javascript",children:"JavaScript"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"async function updateAgenda(uid, updates) {\n  try {\n    const response = await fetch(`https://api.openagenda.com/v2/agendas/${uid}`, {\n      method: 'PATCH',\n      headers: {\n        'Authorization': 'Bearer YOUR_API_KEY',\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(updates)\n    });\n    \n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error.message);\n    }\n    \n    return await response.json();\n    \n  } catch (error) {\n    console.error('Erreur lors de la modification:', error.message);\n    throw error;\n  }\n}\n\n// Utilisation\nconst updates = {\n  title: \"Nouveau titre\",\n  settings: {\n    moderation: \"manual\"\n  }\n};\n\nupdateAgenda('agenda-456', updates)\n  .then(result => console.log('Agenda modifi\xe9:', result.data))\n  .catch(error => console.error('Erreur:', error));\n"})}),"\n",(0,i.jsx)(n.h3,{id:"python",children:"Python"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import requests\n\ndef update_agenda(uid, updates):\n    url = f"https://api.openagenda.com/v2/agendas/{uid}"\n    headers = {\n        \'Authorization\': \'Bearer YOUR_API_KEY\',\n        \'Content-Type\': \'application/json\'\n    }\n    \n    response = requests.patch(url, json=updates, headers=headers)\n    \n    if response.status_code == 200:\n        return response.json()[\'data\']\n    else:\n        error = response.json()\n        raise Exception(f"Erreur: {error[\'error\'][\'message\']}")\n\n# Utilisation\nupdates = {\n    "description": "Description mise \xe0 jour",\n    "settings": {\n        "categories": ["conference", "workshop"]\n    }\n}\n\ntry:\n    result = update_agenda(\'agenda-456\', updates)\n    print(f"Agenda modifi\xe9: {result[\'title\']}")\nexcept Exception as e:\n    print(f"Erreur: {e}")\n'})}),"\n",(0,i.jsx)(n.h3,{id:"php",children:"PHP"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"function updateAgenda($uid, $updates) {\n    $url = \"https://api.openagenda.com/v2/agendas/\" . $uid;\n    $headers = [\n        'Authorization: Bearer YOUR_API_KEY',\n        'Content-Type: application/json'\n    ];\n    \n    $ch = curl_init();\n    curl_setopt($ch, CURLOPT_URL, $url);\n    curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'PATCH');\n    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($updates));\n    curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n    \n    $response = curl_exec($ch);\n    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);\n    \n    if ($httpCode === 200) {\n        return json_decode($response, true)['data'];\n    } else {\n        $error = json_decode($response, true);\n        throw new Exception(\"Erreur: \" . $error['error']['message']);\n    }\n}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},7672:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>a});var r=s(4897);const i={},t=r.createContext(i);function d(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);