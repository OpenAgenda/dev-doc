"use strict";(self.webpackChunkdev_doc=self.webpackChunkdev_doc||[]).push([[815],{2988:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"authentification","title":"Authentification","description":"Comment s\'authentifier en amont des appels API en consultation ou en \xe9dition.","source":"@site/docs/authentification.md","sourceDirName":".","slug":"/authentification","permalink":"/authentification","draft":false,"unlisted":false,"editUrl":"https://github.com/OpenAgenda/dev-doc/docs/authentification.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"apiSidebar","previous":{"title":"Introduction","permalink":"/"},"next":{"title":"Les routes /agendas","permalink":"/agendas"}}');var i=s(4373),a=s(7672);const o={sidebar_position:2},l="Authentification",c={},d=[{value:"En bref",id:"en-bref",level:2},{value:"Consultation seule",id:"consultation-seule",level:2},{value:"\xc9dition",id:"\xe9dition",level:2},{value:"R\xe9cup\xe9ration de la cl\xe9",id:"r\xe9cup\xe9ration-de-la-cl\xe9",level:3},{value:"Utilisation",id:"utilisation",level:3},{value:"Obtention du token d&#39;acc\xe8s",id:"obtention-du-token-dacc\xe8s",level:4},{value:"bash",id:"bash",level:5},{value:"node.js",id:"nodejs",level:5},{value:"Utilisation du token",id:"utilisation-du-token",level:4},{value:"bash",id:"bash-1",level:5},{value:"node.js",id:"nodejs-1",level:5}];function r(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"authentification",children:"Authentification"})}),"\n",(0,i.jsx)(n.p,{children:"Comment s'authentifier en amont des appels API en consultation ou en \xe9dition."}),"\n",(0,i.jsx)(n.h2,{id:"en-bref",children:"En bref"}),"\n",(0,i.jsxs)(n.p,{children:["Les cl\xe9s utiles pour s'authentifier sont disponibles depuis ",(0,i.jsx)(n.a,{href:"https://openagenda.com/settings/apiKey",children:"la page de param\xe8tres"})," de votre compte OpenAgenda."]}),"\n",(0,i.jsx)(n.p,{children:"La proc\xe9dure d'authentification diff\xe8re selon si vous souhaitez lire ou \xe9diter des contenus. La proc\xe9dure pour les \xe9ditions fonctionnera pour les lectures."}),"\n",(0,i.jsx)(n.h2,{id:"consultation-seule",children:"Consultation seule"}),"\n",(0,i.jsx)(n.p,{children:"Passer la cl\xe9 publique d'un compte OpenAgenda en ent\xeate de requ\xeate suffit pour les op\xe9rations de consultation."}),"\n",(0,i.jsx)(n.p,{children:"Un exemple:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -H "key: YOUR_API_KEY" https://api.openagenda.com/v2/agendas\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\xc0 noter"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Il est \xe9galement possible de placer la cl\xe9 en query: ",(0,i.jsx)(n.code,{children:"?key=votrecl\xe9"}),". Cette m\xe9thode n'est pas conseill\xe9e car elle laisse des traces de la cl\xe9s dans des logs & historiques."]}),"\n",(0,i.jsxs)(n.li,{children:["Un ",(0,i.jsx)(n.strong,{children:"token d'acc\xe8s"})," obtenu avec ",(0,i.jsx)(n.strong,{children:"la cl\xe9 secr\xe8te"})," d'un compte peut \xe9galement servir pour les op\xe9rations de lecture."]}),"\n",(0,i.jsxs)(n.li,{children:["Des cl\xe9s de lecture peuvent \xe9galement \xeatre cr\xe9\xe9es depuis l'onglet ",(0,i.jsx)(n.em,{children:"Avanc\xe9"})," de l'administration d'un agenda."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\xe9dition",children:"\xc9dition"}),"\n",(0,i.jsxs)(n.p,{children:["Une cl\xe9 secr\xe8te est n\xe9cessaire pour l'\xe9dition de contenus via API: elle est attribu\xe9e sur simple demande \xe0 ",(0,i.jsx)(n.a,{href:"mailto:support@openagenda.com",children:"support@openagenda.com"})]}),"\n",(0,i.jsx)(n.h3,{id:"r\xe9cup\xe9ration-de-la-cl\xe9",children:"R\xe9cup\xe9ration de la cl\xe9"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Connectez-vous \xe0 votre compte OpenAgenda"}),"\n",(0,i.jsxs)(n.li,{children:["Acc\xe9dez \xe0 la ",(0,i.jsx)(n.a,{href:"https://openagenda.com/settings/apiKey",children:'section "API"'})," dans vos param\xe8tres"]}),"\n",(0,i.jsx)(n.li,{children:"Si n\xe9cessaire, g\xe9n\xe9rez une nouvelle cl\xe9 API secr\xe8te en cliquant sur l'action li\xe9e au champ de pr\xe9sentation de la cl\xe9."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"utilisation",children:"Utilisation"}),"\n",(0,i.jsx)(n.p,{children:"La cl\xe9 secr\xe8te permet la r\xe9cup\xe9ration d'un token d'acc\xe8s \xe0 la dur\xe9e de vie limit\xe9e et qui devra \xeatre pass\xe9 en ent\xeate de toutes les requ\xeates suivantes:"}),"\n",(0,i.jsx)(n.h4,{id:"obtention-du-token-dacc\xe8s",children:"Obtention du token d'acc\xe8s"}),"\n",(0,i.jsxs)(n.p,{children:["Il suffit d'une requ\xeate ",(0,i.jsx)(n.code,{children:"POST"})," sur la route ",(0,i.jsx)(n.code,{children:"https://api.openagenda.com/v2/requestAccessToken"})," avec en ent\xeate, la cl\xe9 secr\xe8te plac\xe9e en face d'une cl\xe9 ",(0,i.jsx)(n.code,{children:"code"}),". Voici quelques exemples:"]}),"\n",(0,i.jsx)(n.h5,{id:"bash",children:"bash"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST "https://api.openagenda.com/v2/requestAccessToken" -H "Content-Type: application/json" -d\'\n{\n  "code": VOTRE_CLE_SECRETE\n}\'\n'})}),"\n",(0,i.jsx)(n.h5,{id:"nodejs",children:"node.js"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"const response = await fetch('https://api.openagenda.com/v2/requestAccessToken', {\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n  },\n  body: JSON.stringify({\n    code: VOTRE_CLE_SECRETE\n  }),\n});\n\nconst {\n  access_token,\n  expires_in\n} = await response.json();\n"})}),"\n",(0,i.jsx)(n.h4,{id:"utilisation-du-token",children:"Utilisation du token"}),"\n",(0,i.jsxs)(n.p,{children:["Une fois le token en main, il est \xe0 passer en ent\xeate de requ\xeate sous une cl\xe9 ",(0,i.jsx)(n.code,{children:"access-token"})," tant que celui-ci n'est pas expir\xe9. Une fois arriv\xe9 \xe0 expiration, un nouveau token doit \xeatre g\xe9n\xe9r\xe9."]}),"\n",(0,i.jsx)(n.h5,{id:"bash-1",children:"bash"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X GET "https://api.openagenda.com/v2/agendas" -H "Content-Type: application/json" -H "key: VOTRE_TOKEN"\n'})}),"\n",(0,i.jsx)(n.h5,{id:"nodejs-1",children:"node.js"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"const response = await fetch('https://api.openagenda.com/v2/agendas', {\n  method: 'GET',\n  headers: {\n    'Content-Type': 'application/json',\n    'key': VOTRE_TOKEN\n  }\n});\n"})})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(r,{...e})}):r(e)}},7672:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var t=s(4897);const i={},a=t.createContext(i);function o(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);